{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'blog/main_blog_page.css' %}" />
<h1>Blog</h1>
{% for post in posts %}
    <div class="post">
        <h2><a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a></h2>
        <p>By {{ post.author }} on {{ post.date_posted|date:"F d, Y" }}</p>
        <p>{{ post.content|truncatewords:30 }}</p>
        {% if post.author == request.user %}
            <form action="{% url 'delete_post' post.pk %}" method="POST" 
                style="display:inline;" onsubmit="return confirmDelete(event);">
                {% csrf_token %}
                <button type="submit" class="delete-btn">
                    <i class="fas fa-trash-alt"></i> Delete
                </button>
            </form>
        {% endif %}
    </div>
{% endfor %}
<a class="nav-link" href="{% url 'create_post' %}">Create Post</a>
<script>
    function confirmDelete(event) {
        event.preventDefault();
    
        let confirmation = confirm("Are you sure you want to delete this post?");
        if (confirmation) {
            event.target.submit();
        }
    }
</script>
{% endblock %}

    